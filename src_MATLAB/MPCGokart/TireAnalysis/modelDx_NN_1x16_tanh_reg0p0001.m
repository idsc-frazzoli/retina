function [ACCX,ACCY,ACCROTZ] = modelDx_NN_1x16_tanh_reg0p0001(VELX,VELY,VELROTZ,BETA,AB,TV, param)
    %param = [B1,C1,D1,B2,C2,D2,Ic];
    B1 = param(1);
    C1 = param(2);
    D1 = param(3);
    B2 = param(4);
    C2 = param(5);
    D2 = param(6);
    Ic = param(7);
    %maxA = param(8);
    magic = @(s,B,C,D)D.*sin(C.*atan(B.*s));
    reg = 0.5;
    capfactor = @(taccx)(1-satfun((taccx/D2)^2))^(1/2);
    simpleslip = @(VELY,VELX,taccx)-(1/capfactor(taccx))*VELY/(VELX+reg);
    %simpleslip = @(VELY,VELX,taccx)-VELY/(VELX+reg);
    simplediraccy = @(VELY,VELX,taccx)magic(simpleslip(VELY,VELX,taccx),B2,C2,D2);
    simpleaccy = @(VELY,VELX,taccx)capfactor(taccx)*simplediraccy(VELY,VELX,taccx);
    %acclim = @(VELY,VELX, taccx)(VELX^2+VELY^2)*taccx^2-VELX^2*maxA^2;
    simplefaccy = @(VELY,VELX)magic(-VELY/(VELX+reg),B1,C1,D1);
    %simpleaccy = @(VELY,VELX,taccx)magic(-VELY/(VELX+reg),B2,C2,D2);



    l = 1.19;
    l1 = 0.73;
    l2 = l-l1;
    f1n = l2/l;
    f2n = l1/l;
    w = 1;
    rotmat = @(beta)[cos(beta),sin(beta);-sin(beta),cos(beta)];
    vel1 = rotmat(BETA)*[VELX;VELY+l1*VELROTZ];
    f1y = simplefaccy(vel1(2),vel1(1));
    F1 = rotmat(-BETA)*[0;f1y]*f1n;
    F1x = F1(1);
    F1y = F1(2);
    frontabcorr = F1x;
    F2x = AB;
    F2y1 = simpleaccy(VELY-l2*VELROTZ,VELX,(AB+TV/2)/f2n)*f2n/2;
    F2y2 = simpleaccy(VELY-l2*VELROTZ,VELX,(AB-TV/2)/f2n)*f2n/2;
    F2y = simpleaccy(VELY-l2*VELROTZ,VELX,AB/f2n)*f2n;
    TVTrq = TV*w;
    
    
    ACCROTZ_NOM = (TVTrq + F1y*l1 -F2y*l2)/Ic;
    %ACCROTZ = TVTrq + F1y*l1;
    ACCX_NOM = F1x+F2x+VELROTZ*VELY;
    ACCY_NOM = F1y+F2y1+F2y2-VELROTZ*VELX;
    
    w1 = [0.6428456 0.1504234 0.6279734 0.52479595 -1.1553059 -0.22599536 0.52514166 -0.5998141 2.7122803 -0.43926728 0.75646484 0.29873663 0.4629565 -1.1747786 -1.0259486 0.531815;-2.460366 2.5804756 0.85209155 -0.6291104 -2.7524471 -0.6938958 0.38175976 0.25926733 -3.439829 -0.3355751 -1.1531366 -0.15666814 -0.052904714 -1.4676486 0.76452655 -2.2829368;1.4526141 -1.2397144 -0.852899 0.7290545 1.589082 -0.5713222 -0.68709123 0.25316736 2.1915843 -0.6319396 -2.4754775 -0.19919507 0.7003119 1.2798837 -0.8688717 1.2186385;-0.2657224 -0.1739676 -0.15044388 -0.51357275 -0.2747391 1.6605297 0.37507212 -0.8804165 -0.11106464 -0.30211076 0.47753173 -0.18739203 -0.1141059 -0.2601783 0.5176427 0.4001719;0.027626198 0.0005692832 0.10653574 -0.051745865 0.02863567 0.0306036 -0.04756277 0.07814999 0.01734806 -0.07268699 -0.05566966 -0.017093226 -0.036294904 0.02680781 0.060509473 0.17834282;0.12056561 -0.012907056 0.108701184 -0.064222105 0.08336868 -0.22311237 0.017899523 -0.12905107 0.23533706 0.64039946 1.853716 -0.19938678 0.11950652 0.05572342 -0.21838573 -0.072718844];
    b1 = [0.9680729 0.3573398 1.034094 -1.0970296 -1.8917058 0.10578425 -1.2095199 0.92801696 3.905301 -0.7307687 0.63424796 -0.76070374 -1.3204128 -0.4695564 -0.18586813 1.261051];
    w2 = [0.8828904 -2.7301745 -2.1550243;0.112915754 2.8984916 0.9001704;-1.0283288 0.9635533 -2.9458127;0.22439021 3.4968421 2.0705168;-0.5331297 -2.8616781 -1.9545213;-0.14553383 -0.46011335 -1.507945;-0.17823434 -4.241532 -0.30770198;-0.05832443 0.9815098 2.8953218;0.04462789 -2.0920856 0.032682166;-0.17471544 -0.17269988 -2.2890387;0.07938692 -0.1487321 -1.0278243;0.13539644 -0.5890919 3.403239;-0.13308671 1.6876912 -2.2881737;-0.1316318 2.064277 0.88483435;0.15494059 -1.5796243 -1.6296331;-1.1063699 0.64658356 1.9672917];
    b2 = [0.39494818 -0.21396782 -0.4930085];
    means = [2.6775749832578986 0.001922168301437502 -0.04515304867653743 -0.026195759869689427 0.06460829512732788 -0.0686602322088558];
    stds = [1.907241556285694 0.3079627568782051 0.5515613235298231 0.20101736434516326 0.8309067855283836 0.634574245360539];
    
    normed_input = (input - means) ./ stds;

    h1 = tanh(normed_input * w1 + b1);
    disturbance = h1 * w2 + b2;
    
    ACCX = ACCX_NOM + disturbance(1);
    ACCY = ACCY_NOM + disturbance(2);
    ACCROTZ = ACCROTZ_NOM + disturbance(3);
end

